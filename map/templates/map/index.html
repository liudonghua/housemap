
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>富Marker示例</title>

<script type="text/javascript" src="http://api.map.baidu.com/api?v=1.5&ak=4njKw2jG5KoKs6Rha1D2G3L2"></script>
<script type="text/javascript" src="http://api.map.baidu.com/library/RichMarker/1.2/src/RichMarker_min.js"></script>
<style>
body{margin:0;padding:0}
</style>
</head>
<body>
<div style="width:700px;height:400px;border:1px solid gray;margin:10px 0 0 10px;" id="container">
</div>

<script type="text/javascript">
var lng,lat;
window.onload =getLocation;
function getLocation()
  {
  if (navigator.geolocation)
    {
    navigator.geolocation.getCurrentPosition(showPosition);
    }
  else{alert("please turn on geography switch!");}
  }
function showPosition(position)
  {
 		lng = position.coords.latitude ; 
  		lat	 = position.coords.longitude;   
  }

var map = new BMap.Map("container");
map.centerAndZoom(new BMap.Point(lng,lat), 10);
map.enableScrollWheelZoom();
showHouse();

function showHouse()	
{
		var bs = map.getBounds();   //获取可视区域
	var bssw = bs.getSouthWest();   //可视区域左下角
	var bsne = bs.getNorthEast(); 
	var data = {
		east	: bsne.lng,
		west	: bssw.lng,
		south	: bssw.lat,
		north	: bsne.lat,
	};
	$.get('map/house/',data,function(datas){
		for(data in datas){
			var html2 = '<a class="house_point" href="'+data.href+'"><div style="position: absolute; margin: 0pt; padding: 0pt; width: 80px; height: 26px; left: -10px; top: -35px; overflow: hidden;">'
			                +     '<img id="rm3_image" style="border:none;left:0px; top:0px; position:absolute;" src="http://api.map.baidu.com/library/RichMarker/1.2/examples/images/back1.png">'
							+ '</div>'
							+ '<label class=" BMapLabel" unselectable="on" style="position: absolute; -moz-user-select: none; display: inline; cursor: inherit; border: 0px none; padding: 2px 1px 1px; white-space: nowrap; font: 12px arial,simsun; z-index: 80; color: rgb(255, 102, 0); left: 15px; top: -35px;"> '+data.price+'</label></a>',
			      myRichMarker2 = new BMapLib.RichMarker(html2,  new BMap.Point(data.lang,data.lat),{
			                                                  "anchor" : new BMap.Size(-18, -27),
															  "enableDragging" : false});
			map.addOverlay(myRichMarker2);
	
		}
	});
}
</script>

</body>
</html>